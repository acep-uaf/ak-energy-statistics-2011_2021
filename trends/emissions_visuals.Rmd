---
title: "emissions visuals"
output: html_document
date: "2024-02-08"
editor_options: 
  chunk_output_type: console
---


### library
```{R}
options(scipen=999)

library(ggplot2)
library(dplyr)
library(readr)

library(see)


```


## load 
```{R}
repo <- "~/repos/ak-energy-statistics-2011_2021/"
setwd(repo)


generation_emissions <- read_csv("./trends/raw/generation_emissions.csv")


```








# boxplot
```{R}
# plot
tmp <- generation_emissions %>%
  group_by(`ACEP Energy Region`, `Year`) %>%
  summarize(emissions = sum(`CO2 Metric Tons from Fuel`, na.rm = TRUE),
            generation = sum(`Generation (PCE=gross, EIA=net)  MWh`, na.rm = TRUE)) %>%
  mutate(CO2_per_MWh = emissions/generation)

tmp %>%
  filter(Year != 2020) %>%
  ggplot(aes(x = Year, y = emissions, fill = `ACEP Energy Region`)) +
  geom_line()


  # validation aggregation
aggregate(`Plant Name` ~ Year + `ACEP Energy Region`, generation_emissions, FUN = function(x) length(x))








  mutate(`kg CO2 per MWh` = ((`CO2 Metric Tons from Fuel`*1000)/`Generation (PCE=gross, EIA=net)  MWh`)) %>%
  filter(Year == 2021) %>%
  drop_na(`ACEP Energy Region`) %>%
  ggplot( aes(x=`ACEP Energy Region`, y=(`kg CO2 per MWh`), fill=`ACEP Energy Region`)) +
    # geom_boxplot(outlier.alpha = 0) +
    geom_boxplot(outlier.alpha = 0) +
    scale_fill_manual(values = c("#98BAD6", "#A4CD9A", "#E3918F", "#F1BF42")) +
    geom_jitter(color="black", size=0.4, alpha=0.8, width = 0.1, height = 0) +
    theme_classic() +
    theme(legend.position = "none",
          plot.title = element_text(size=20, hjust = 0.5),
          plot.subtitle = element_text(size=14, hjust = 0.5),
          plot.caption = element_text(size = 8)) +
  
    labs(title = "CO2",
         subtitle = "lorem",
         caption = "lorem",
         x = "Region",
         y = "kg CO2 per MWh") +
  
    coord_flip() +
  
    ylim(0,1000)
    



```